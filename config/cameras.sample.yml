general:
  storage_root: /home/animaltracker/storage
  logs_root: /home/animaltracker/logs
  metrics_port: 9500
  clip:
    pre_seconds: 5
    post_seconds: 5
    format: mp4
    codec: h264
    # Thumbnail settings
    thumbnail_cropped: true      # true=zoomed to animal, false=full frame with bbox
    # Post-clip analysis: re-analyze frames after recording for better species ID
    post_analysis: true          # Enable post-clip species refinement
    # False positive cleanup: if post-processing finds NO animal, delete clip & skip alert
    delete_if_no_animal: true    # Reduces false positives from real-time detector
    # Frames to analyze are auto-calculated: ~1 per second of clip (min 5, max 60)
    # Object tracking: track same animal across frames for consistent identification
    tracking_enabled: true       # Uses ByteTrack to assign persistent IDs
  # Detector backend configuration
  detector:
    # SPLIT-MODEL ARCHITECTURE (recommended for PTZ tracking):
    # - realtime_backend: Fast detector for live streaming/PTZ tracking
    # - postprocess_backend: Accurate detector for clip analysis
    realtime_backend: yolo        # YOLO: ~50-150ms inference (fast for tracking)
    postprocess_backend: speciesnet  # SpeciesNet: ~200-500ms (accurate species ID)
    
    # Legacy single-backend setting (overridden by split-model settings above)
    backend: yolo
    
    # YOLO settings (used when backend/realtime_backend: yolo)
    model_path: yolov8n.pt
    # SpeciesNet settings (used when backend/postprocess_backend: speciesnet)
    speciesnet_version: v4.0.2a  # v4.0.2a (crop) or v4.0.2b (full-image)
    # Location priors for better species accuracy (filters out impossible species)
    country: USA                  # ISO 3166-1 alpha-3 code (e.g., USA, CAN, GBR)
    admin1_region: MN             # State/province code (US states supported)
    latitude: 45.0105             # Camera latitude (optional, for future use)
    longitude: -93.4555           # Camera longitude (optional, for future use)
    # Tiered confidence: generic categories (animal, bird) need higher confidence
    # Specific species (cardinal, blue_jay) use camera's normal threshold
    generic_confidence: 0.9       # Threshold for generic labels (0.0-1.0)
  # eBird integration for seasonal bird filtering (optional)
  ebird:
    enabled: false                # Set to true and add API key to secrets.env
    region: US-MN                 # eBird region code (e.g., US-MN, US-CA, CA-ON)
    days_back: 14                 # Days of recent sightings to check (1-30)
    filter_mode: flag             # flag: log unusual, filter: reject unseen, boost: prioritize common
    cache_hours: 24               # How long to cache eBird data
    api_key_env: EBIRD_API_KEY    # Environment variable for API key
  exclusion_list:
    - squirrel
  notification:
    pushover_app_token_env: PUSHOVER_APP_TOKEN
    pushover_user_key_env: PUSHOVER_USER_KEY
    # Web UI base URL for clickable video links in notifications
    # Example: http://192.168.1.100:8080 (your Jetson/server IP and port)
    web_base_url: null
  retention:
    min_days: 7
    max_days: 30
    max_utilization_pct: 80

cameras:
  - id: cam1
    name: "Front Gate"
    location: "North Fence"
    rtsp:
      uri: "rtsp://{USERNAME}:{PASSWORD}@192.168.1.201:554/Streaming/Channels/101"
      transport: tcp
      latency_ms: 0
      hwaccel: false  # Set to true for NVDEC GPU decoding (requires GStreamer)
    onvif:
      host: 192.168.1.201
      port: 80
      profile: "Profile_1"
      username_env: CAM1_ONVIF_USER
      password_env: CAM1_ONVIF_PASS
    thresholds:
      confidence: 0.5
      min_frames: 3
    # PTZ auto-tracking: follow detected animals with PTZ camera
    # Optimized defaults for split-model architecture (YOLO realtime)
    ptz_tracking:
      enabled: false              # Enable PTZ auto-tracking
      self_track: false           # Camera centers on its own detections
      target_fill_pct: 0.6        # Target 60% frame fill
      # Optimized for YOLO's ~50-150ms inference
      update_interval: 0.1        # 10 PTZ updates/sec (fast response)
      smoothing: 0.15             # Low smoothing for quick movement
      patrol_return_delay: 2.0    # Quick return to patrol when animal lost
      patrol_enabled: true        # Sweep when no detections
      patrol_speed: 0.08          # Slow patrol for detection
    include_species:
      - deer
      - bear
    exclude_species:
      - squirrel
    notification:
      priority: 0
      sound: pushover

  - id: cam2
    name: "Creek Crossing"
    location: "South Ridge"
    rtsp:
      uri: "rtsp://{USERNAME}:{PASSWORD}@192.168.1.202:554/live"
      transport: udp
      latency_ms: 100
    onvif:
      host: 192.168.1.202
      port: 80
      profile: "main"
      username_env: CAM2_ONVIF_USER
      password_env: CAM2_ONVIF_PASS
    thresholds:
      confidence: 0.45
      min_frames: 2
    include_species:
      - coyote
      - bobcat
    exclude_species: []
    notification:
      priority: 1
      sound: siren
